# Процесс решения задач:
- 1 этап
  - Разбор внутренностей segfast - 4 часа, сделан jupyter - решения перенесены в проект на claude:
  - визуализация - 1 день
  - МЛ - 1 день
  - Результат был отправлен в четверг
- 2 Этап
  - исправление ошибок обучения и эксперименты - 1 день 
  - рефакторинг
  - Эксперименты с ML - 3 ночи.

# Известные проблемы загрузчика данных и данных(SeismicSliceReader)
   - Неизвестны параметры временной шкалы
   - Добавлена проверка на пропуски трасс (последняя трасса)
   - memmap для apple silicon. Отсутсвует оптимизация по этой причине (как вариант перезаписать все в hdf5). Пока проблем с этим нет
   - В документации не найдена информация про возможные заголовки (segfast_file.load_headers(['INLINE_3D', 'CROSSLINE_3D'] и координаты x y)
   - Выбросы (добавить обработку по правилу трех сигм)
   - Слишком сильное усиление сигнала для последних записей (возможно так и надо, в seg возможно есть про это информация)
   - 

# Известные проблемы визуализатора
- Красная линия на слайде
   - Описание: При просмотре некоторых слайдов появляется неожиданная красная линия.
   - Возможные причины: 
     - Артефакт визуализации
     - Проблема с загрузкой или обработкой данных

- Синяя полоса в режиме DEPTH
  - Описание: В режиме DEPTH синяя полоса на слайде начинается не с начала изображения.
  - Возможные причины:
    - Неправильное выравнивание данных
    - Ошибка в расчете отображаемой области

- Для получения информации что он него нужно, можно спросить сейсмиков что с ним работают)
- При сохранении картинки не сохраняется шкала


3. Общие замечания:
   - Стоит рассмотреть вопрос о добавлении дополнительных опций настройки отображения и фильтрации для пользователя
   - Отсутствует масштабирование и изменение контраста данных
   - Возможно перепутанны оси в режиме depth
   - Есть пропуски при отображении трасс, природа этих пропусков точно не определена (лучше смотреть в данные и дополнительно слайсы оценивать)
   - Иногда не отвечает слайдер 
   
    
# Проблемы обучения

1. Нужно нормально настроить снижение loss (посмотреть в примерах)
4. Стоит ли ставить в конце функцию активации?
5. Неоптимизированная загрузка данных из даталоадера 
   - m1 chip + torch
   - большое потребление памяти, сейчас 12 gb на 32:256:256
6. Проблемы семплов 
   - изображения 256:256
   - МАСШТАБИРУЮТСЯ!!! -> выдумывание данных
   - для сета на 32:512:512 медленная работа с памятью
7. !!!!Действительно важная штука, фичи
   - для корректности диффузии можно оценивать также параметры сейсмической записи как в этом примере через librosa (самый проостой и проверенный вариант:
     ![img.png](img.png)
   - для генерации на выходе брать только первый слой 
8. Граничные условия, возможно на вход стоит подавать большую область
9. Создать логирование параметров обучения
10. Сейчас просто unet, стоит поискать актуальные модели и поробовать более простые.
11. Оформление и тестовые прогоны

# Предложения и комментарии:
## Визуализатор
- Сделан рефакторинг, теперь три класса: reader, plot, interact_plot. Можно работать
- Можно попробовать реализовать 3D режим:
  - обрезка по трем плоскостям
  - прозрачный режим по чуствительности
- Добавление обработки данных (лучше как отдельный класс):
  - Выделение мощности сигнала
  - изменение усиления
  - изменение цветовой шкалы
- Ограничение слайсов по двум дополнительным осям, нужно подвязывать информацию из segfast

## Диффузионная модель
- не сделан рефакторинг
- Считаю более корректным генерировать литологию, потом сейсмику:
  - По датасету литологии-временной_разрез можно создать нейронку для ускорения процесса
  - Есть пример на гитхабе
- Функция активации и преобразование данных
  - стоит ли преобразовывать данные к [0, 1] (сейчас [-1, 1]) и функции активации под них
  - не отброшены выбросы
  - стоит ли сделать преобразование для "сплющивания" нормального распределения?
  - функция активации на выходном слое (сейчас линейная, тангенсальная не работала, скорее всего из-за уровня шумов)?
- Шум:
  - Сопоставить уровень шума с сейсмикой
  - Неправильно инициализированно добавление шума (в последней итерации добавлял на глаз)
  - Текущий код слишком запутан
- Качество результата:
  - необходима оценки реалистичности сейсмики, моделям сложно распознать волновое поле. Текущий вариант работает для изображения 64/64, но не больше
  - Текущий лосс - MSE. Добавлен лосс VLB, результат стал хуже 
- Возможные эксперименты:
  - создать модель для последовательного повышения размерности, в том числе из нескольких пикселей. Наверное есть подобная практическая реализация генераторов
  - Добавление оценки волнового поля:
    - Пример: Сравнивать АЧХ на входе и на выходе  
    - Проблема: мне нужно сопоставить размеры ошибок и сделать кастомный лосс
    - Это подойдет для соревновательного алгоритма
    - Изменение формы свертки - сейчас квадрат, а у нас запись вытянута

    